"use strict";var caltrainServiceData={saturdayTripIds:[421,480,481,484],northStops:["Gilroy","San Martin","Morgan Hill","Blossom Hill","Capitol","Tamien","San Jose Diridon","College Park","Santa Clara","Lawrence","Sunnyvale","Mountain View","San Antonio","California Ave","Palo Alto","Menlo Park","Redwood City","San Carlos","Belmont","Hillsdale","Hayward Park","San Mateo","Burlingame","Broadway","Millbrae","San Bruno","So San Francisco","Bayshore","22nd Street","San Francisco"],northWeekday:{147:[,,,,,255,262,,268,275,279,284,288,293,297,300,306,311,314,318,321,325,328,,333,338,342,349,355,361],149:[,,,,,303,310,,316,323,327,332,336,341,345,348,354,359,362,366,369,373,376,,381,386,390,397,403,409],519:[,,,,,,345,,352,,359,364,,,372,375,383,,,390,,395,,,401,,,,414,421],151:[,,,,,363,370,,376,383,387,392,396,401,405,408,414,419,422,426,429,433,436,,441,446,450,457,463,469],521:[355,364,370,385,391,398,405,,412,,419,424,,,432,435,443,,,450,,455,,,461,,,,474,481],153:[378,387,393,408,414,421,430,,436,443,447,452,456,461,465,468,474,479,482,486,489,493,496,,501,506,510,517,523,529],523:[412,422,429,443,450,456,463,468,472,,479,484,,,492,495,503,,,510,,515,,,521,,,,534,541],155:[,,,,,481,490,,496,503,507,512,516,521,525,528,534,539,542,546,549,553,556,,561,566,570,577,583,589],525:[,,,,,,525,,532,,539,544,,,552,555,563,,,570,,575,,,581,,,,594,601],157:[,,,,,541,550,,556,563,567,572,576,581,585,588,594,599,602,606,609,613,616,,621,626,630,637,643,649],527:[,,,,,,585,,592,,599,604,,,612,615,623,,,630,,635,,,641,,,,654,661],159:[,,,,,601,610,,616,623,627,632,636,641,645,648,654,659,662,666,669,673,676,,681,686,690,697,703,709],529:[,,,,,,645,,652,,659,664,,,672,675,683,,,690,,695,,,701,,,,714,721],161:[,,,,,661,670,,676,683,687,692,696,701,705,708,714,719,722,726,729,733,736,,741,746,750,757,763,769],531:[,,,,,,705,,1432,,719,724,,,732,735,743,,,750,,755,,,761,,,,774,781],163:[,,,,,721,730,,736,743,747,752,756,761,765,768,774,779,782,786,789,793,796,,801,806,810,817,823,829],533:[,,,,,,765,,772,,779,784,,,792,795,803,,,810,,815,,,821,,,,834,841],165:[,,,,,781,790,,796,803,807,812,816,821,825,828,834,839,842,846,849,853,856,,861,866,870,877,883,889],535:[,,,,,,825,,832,,839,844,,,852,855,863,,,870,,875,,,881,,,,894,901],167:[,,,,,841,850,,856,863,867,872,876,881,885,888,894,899,902,906,909,913,916,,921,926,930,937,943,949],537:[,,,,,,885,,892,,899,904,,,912,915,923,,,930,,935,,,941,,,,954,961],169:[,,,,,899,908,913,916,922,927,932,936,941,945,948,954,958,962,966,969,973,976,,981,986,990,997,1002,1009],539:[,,,,,,945,,952,,959,964,,,972,975,983,,,990,,995,,,1001,,,,1014,1021],171:[,,,,,961,970,,976,983,987,992,996,1001,1005,1008,1014,1019,1022,1026,1029,1033,1036,,1041,1046,1050,1057,1063,1069],541:[,,,,,,1005,,1012,,1019,1024,,,1032,1035,1043,,,1050,,1055,,,1061,,,,1074,1081],173:[,,,,,1021,1030,,1036,1043,1047,1052,1056,1061,1065,1068,1074,1079,1082,1086,1089,1093,1096,,1101,1106,1110,1117,1123,1129],543:[,,,,,,1065,,1072,,1079,1084,,,1092,1095,1103,,,1110,,1115,,,1121,,,,1134,1141],175:[,,,,,1081,1090,,1096,1103,1107,1112,1116,1121,1125,1128,1134,1139,1142,1146,1149,1153,1156,,1161,1166,1170,1177,1183,1189],545:[,,,,,,1125,,1132,,1139,1144,,,1152,1155,1163,,,1170,,1175,,,1181,,,,1194,1201],177:[,,,,,1141,1150,,1156,1163,1167,1172,1176,1181,1185,1188,1194,1199,1202,1206,1209,1213,1216,,1221,1226,1230,1237,1243,1249],547:[,,,,,,1185,,1192,,1199,1204,,,1212,1215,1223,,,1230,,1235,,,1241,,,,1254,1261],179:[,,,,,1201,1210,,1216,1223,1227,1232,1236,1241,1245,1248,1254,1259,1262,1266,1269,1273,1276,,1281,1286,1290,1297,1303,1309],181:[,,,,,,1236,,1242,1249,1253,1258,1262,1267,1271,1274,1282,1287,1290,1294,1297,1301,1304,,1309,1314,1318,1325,1331,1337],183:[,,,,,1261,1270,,1276,1283,1287,1292,1296,1301,1305,1308,1314,1319,602,1326,609,1333,1336,,1341,1346,1350,1357,1363,1369]},northWeekend:{629:[,,,,,,377,,383,389,393,408,422,432,440,444,459,469,489,492,495,499,502,505,509,514,518,524,530,536],633:[,,,,,465,472,,478,484,488,503,517,527,535,539,554,564,604,608,611,615,619,622,626,630,634,641,646,652],225:[,,,,,545,552,,558,564,568,583,597,607,615,619,634,644,664,668,671,675,679,682,686,690,694,701,706,713],229:[,,,,,605,612,,618,624,628,643,657,667,675,679,694,704,724,728,731,735,739,742,746,750,754,761,766,773],233:[,,,,,665,672,,678,684,688,703,717,727,735,739,1474,764,784,788,791,795,799,802,806,810,814,821,826,832],237:[,,,,,,732,,738,1464,748,763,777,787,795,799,1534,824,844,848,851,855,859,862,866,870,874,881,886,892],241:[,,,,,785,792,,798,804,808,823,837,847,855,859,1594,884,904,908,911,915,919,922,926,930,934,941,946,952],245:[,,,,,,852,,858,864,868,883,897,907,915,919,934,944,964,968,971,975,979,982,986,990,994,1001,1006,1012],249:[,,,,,905,912,,918,924,928,943,957,967,975,979,994,1004,1024,1028,1031,1035,1039,1042,1046,1050,1054,1061,1066,1072],253:[,,,,,,972,,978,984,988,1003,1017,1027,1035,1039,1054,1064,1084,1088,1091,1095,1099,1102,1106,1110,1114,1121,1126,1132],257:[,,,,,1025,1032,,1038,1044,1048,1063,1077,1087,1095,1099,1114,1124,1144,1148,1151,1155,1159,1162,1166,1170,1174,1181,1186,1192],261:[,,,,,,1092,,1098,1104,1108,1123,1137,1147,1155,1159,1174,1184,1204,1208,1211,1215,1219,1222,1226,1230,1234,1241,1246,1252],265:[,,,,,1145,1152,,1158,1164,1168,1183,1197,1207,1215,1219,1234,1244,1264,1268,1271,1275,1279,1282,1286,1290,1294,1301,1306,1312],269:[,,,,,,1212,,1218,1224,1228,1243,1257,1267,1275,1279,1294,1304,1324,1328,1331,1335,1339,1342,1346,1350,1354,1361,1366,1372],637:[,,,,,1261,1270,,1276,1283,1287,1301,1315,1325,1333,1337,1352,1362,1390,1394,1397,1401,1405,1408,1412,1417,1421,1427,1433,1439]},northModified:{601:[,,,,,270,276,,282,288,292,297,301,305,309,312,318,323,326,330,333,336,340,343,346,351,355,361,367,372],603:[,,,,,,312,,318,324,328,334,337,342,346,350,356,361,364,368,371,375,379,382,386,390,394,401,406,412],605:[,,,,,365,372,,378,384,388,394,397,402,406,410,416,421,424,428,431,435,439,442,446,450,454,461,466,472],607:[382,391,397,412,418,425,432,,438,444,448,454,457,462,466,470,476,481,484,488,491,495,499,502,506,510,514,521,526,532],609:[,,,,,485,492,,498,504,508,514,517,522,526,530,536,541,544,548,551,555,559,562,566,570,574,581,586,592],225:[,,,,,545,552,,558,564,568,574,577,582,586,590,596,601,604,608,611,615,619,622,626,630,634,641,646,652],629:[,,,,,,612,,618,624,628,634,637,642,646,650,656,661,664,668,671,675,679,682,686,690,694,701,706,713],233:[,,,,,665,672,,678,684,688,694,697,702,706,710,716,721,724,728,731,735,739,742,746,750,754,761,766,773],237:[,,,,,,732,,738,744,748,754,757,762,766,770,776,781,784,788,791,795,799,802,806,810,814,821,826,832],241:[,,,,,785,792,,798,804,808,814,817,822,826,830,836,841,844,848,851,855,859,862,866,870,874,881,886,892],245:[,,,,,,852,,858,864,868,874,877,882,886,890,896,901,904,908,911,915,919,922,926,930,934,941,946,952],249:[,,,,,905,912,,918,924,928,934,937,942,946,950,956,961,964,968,971,975,979,982,986,990,994,1001,1006,1012],253:[,,,,,,972,,978,984,988,994,997,1002,1006,1010,1016,1021,1024,1028,1031,1035,1039,1042,1046,1050,1054,1061,1066,1072],257:[,,,,,1025,1032,,1038,1044,1048,1054,1057,1062,1066,1070,1076,1081,1084,1088,1091,1095,1099,1102,1106,1110,1114,1121,1126,1132],261:[,,,,,,1092,,1098,1104,1108,1114,1117,1122,1126,1130,1136,1141,1144,1148,1151,1155,1159,1162,1166,1170,1174,1181,1186,1192],265:[,,,,,1145,1152,,1158,1164,1168,1174,1177,1182,1186,1190,1196,1201,1204,1208,1211,1215,1219,1222,1226,1230,1234,1241,1246,1252],269:[,,,,,,1212,,1218,1224,1228,1234,1237,1242,1246,1250,1256,1261,1264,1268,1271,1275,1279,1282,1286,1290,1294,1301,1306,1312],273:[,,,,,1265,1272,,1278,1284,1288,1294,1297,1302,1306,1310,1316,1321,1324,1328,1331,1335,1339,1342,1346,1350,1354,1361,1366,1372],277:[,,,,,,1339,,1345,1351,1355,1360,1364,1368,1373,1376,1382,1387,1390,1394,1397,1401,1405,1408,1412,1417,1421,1427,1433,1439],281:[,,,,,1385,1392,,1398,1404,1408,1414,1417,1422,1426,1430,1436,1441,1444,1448,1451,1455,1459,1462,1466,1470,1474,1481,1486,1492]},southStops:["San Francisco","22nd Street","Bayshore","So San Francisco","San Bruno","Millbrae","Broadway","Burlingame","San Mateo","Hayward Park","Hillsdale","Belmont","San Carlos","Redwood City","Menlo Park","Palo Alto","California Ave","San Antonio","Mountain View","Sunnyvale","Lawrence","Santa Clara","College Park","San Jose Diridon","Tamien","Capitol","Blossom Hill","Morgan Hill","San Martin","Gilroy"],southWeekday:{148:[294,300,306,312,316,321,,326,330,333,336,341,344,349,356,360,364,369,373,378,383,389,,395,,,,,,],150:[322,328,334,340,344,349,,354,358,361,364,369,372,377,382,386,390,395,399,404,409,415,,425,430,,,,,],520:[370,376,,,,390,,,396,,400,,,408,416,419,,,426,432,,439,,446,,,,,,],152:[382,388,394,400,404,409,,414,418,421,424,429,432,437,442,446,450,455,459,464,469,475,478,486,491,,,,,],522:[430,436,,,,450,,,456,,460,,,468,476,479,,,486,492,,499,,506,,,,,,],154:[442,448,454,460,464,469,,474,478,481,484,489,492,497,502,506,510,515,519,524,529,535,,545,550,,,,,],524:[490,496,,,,510,,,516,,520,,,528,536,539,,,546,552,,559,,566,,,,,,],156:[502,508,514,520,524,529,,534,538,541,544,549,552,557,562,566,570,575,579,584,589,595,,605,610,,,,,],526:[550,556,,,,570,,,576,,580,,,588,596,599,,,606,612,,619,,626,,,,,,],158:[562,568,574,580,584,589,,594,598,601,604,609,612,617,622,626,630,635,639,644,649,655,,665,670,,,,,],528:[610,616,,,,630,,,636,,640,,,648,656,659,,,666,672,,679,,686,,,,,,],160:[622,628,634,640,644,649,,654,658,661,664,669,672,677,682,686,690,695,699,704,709,715,,725,730,,,,,],530:[670,676,,,,690,,,696,,700,,,708,716,719,,,726,732,,739,,746,,,,,,],162:[682,688,694,700,704,709,,714,718,721,724,729,732,737,742,746,750,755,759,764,769,775,,785,790,,,,,],532:[730,736,,,,750,,,756,,760,,,768,776,779,,,786,792,,799,,806,,,,,,],164:[742,748,754,760,764,769,,774,778,781,784,789,792,797,802,806,810,815,819,824,829,835,,845,850,,,,,],534:[790,796,,,,810,,,816,,820,,,828,836,839,,,846,852,,859,,866,,,,,,],166:[802,808,814,820,824,829,,834,838,841,844,849,852,857,862,866,870,875,879,884,889,895,,905,910,,,,,],536:[850,856,,,,870,,,876,,880,,,888,896,899,,,906,912,,919,,926,,,,,,],168:[862,868,874,880,884,889,,894,898,901,904,909,912,917,922,926,930,935,939,944,949,955,,965,970,,,,,],538:[910,916,,,,930,,,936,,940,,,948,956,959,,,966,972,,979,983,989,995,282,1008,1021,1027,1040],170:[922,928,934,940,944,949,,954,958,961,964,969,972,977,982,986,990,995,999,1004,1009,1015,,1025,1030,,,,,],540:[970,976,,,,990,,,996,,1000,,,1008,1016,1019,,,1026,1032,,1039,,1046,,,,,,],172:[982,988,994,1000,1004,1009,,1014,1018,1021,1024,1029,1032,1037,1042,1046,1050,1055,1059,1064,1069,1075,,1085,1091,1098,1104,1117,1123,1136],542:[1030,1036,,,,1050,,,1056,,1060,,,1068,1076,1079,,,1086,1092,,1099,,1108,1114,1121,1127,1140,1146,1159],174:[1042,1048,1054,1060,1064,1069,,1074,1078,1081,1084,1089,1092,1097,1102,1106,1110,1115,1119,1124,1129,1135,,1145,1150,,,,,],544:[1090,1096,,,,1110,,,1116,,1120,,,1128,1136,1139,,,1146,1152,,1159,,1166,,,,,,],176:[1102,1108,1114,1120,1124,1129,,1134,1138,1141,1144,1149,1152,1157,1162,1166,1170,1175,1179,1184,1189,1195,,1205,1210,,,,,],546:[1150,1156,,,,1170,,,1176,,1180,,,1188,1196,1199,,,1206,1212,,1219,,1226,,,,,,],178:[1162,1168,1174,1180,1184,1189,,1194,1198,1201,1204,1209,1212,1217,1222,1226,1230,1235,1239,1244,1249,1255,,1265,1270,,,,,],548:[1210,1216,,,,1230,,,1236,,1240,,,1248,1256,1259,,,1266,1272,,1279,,1286,,,,,,],180:[1222,1228,1234,1240,1244,1249,,1254,1258,1261,1264,1269,1272,1277,1282,1286,1290,1295,1299,1304,1309,1315,,1323,1328,,,,,],182:[1254,1260,1266,1272,1276,1281,,1286,1290,1293,1296,1301,1304,1309,1316,1320,1324,1329,1333,1338,1343,1349,,1355,,,,,,],184:[1282,1288,1294,1300,1304,1309,,1314,1318,1321,1324,1329,1332,1337,1342,1346,1350,1355,1359,1364,1369,1375,,1383,1388,,,,,]},southWeekend:{630:[423,428,433,1160,444,449,452,456,459,462,466,479,486,493,506,1232,520,530,585,591,595,601,,610,615,,,,,],224:[508,513,518,525,529,533,537,540,544,547,550,564,571,578,591,597,605,615,676,681,686,692,,700,705,,,,,],228:[598,603,608,615,619,624,627,631,634,637,641,654,661,668,681,687,695,705,736,741,746,752,,760,765,,,,,],232:[658,663,668,675,679,684,687,691,694,697,701,714,721,728,741,747,755,765,796,801,806,812,,818,,,,,,],236:[718,723,728,735,739,744,747,751,754,757,761,774,781,788,801,807,815,825,856,861,866,872,,880,885,,,,,],240:[778,783,788,795,799,804,807,811,814,817,821,834,841,848,861,867,875,885,916,921,926,932,,938,,,,,,],244:[838,843,848,855,859,864,867,871,874,877,881,894,901,908,921,927,935,945,976,981,986,992,,1000,1005,,,,,],248:[898,903,908,915,919,924,927,931,934,937,941,954,961,968,981,987,995,1005,1036,1041,1046,1052,,1058,,,,,,],252:[958,963,968,975,979,984,987,991,994,997,1001,1014,1021,1028,1041,1047,1055,1065,1096,1101,1106,1112,,1120,1125,,,,,],256:[1018,1023,1028,1035,1039,1044,1047,1051,1054,1057,1061,1074,1081,1088,1101,1107,1115,1125,1156,1161,1166,1172,,1178,,,,,,],260:[1078,1083,1088,1095,1099,1104,1107,1111,1114,1117,1121,1134,1141,1148,1161,1167,1175,1185,1216,1221,1226,1232,,1240,1245,,,,,],264:[1138,1143,1148,1155,1159,1164,1167,1171,1174,1177,1181,1194,1201,1208,1221,1227,1235,1245,1276,1281,1286,1292,,1298,,,,,,],268:[1198,1203,1208,1215,1219,1224,1227,1231,1234,1237,1241,1254,1261,1268,1281,1287,1295,1305,1336,1341,1346,1352,,1360,1365,,,,,],272:[1258,1263,1268,1275,1279,1284,1287,1291,1294,1297,1301,1314,1321,1328,1341,1347,1355,1365,1385,,,,,,,,,,,],634:[1282,1288,1294,1300,1304,1309,1313,1316,1320,1323,1326,1340,1345,1350,1358,1364,1370,1378,1396,1401,1406,1412,,1420,1425,,,,,]},southModified:{602:[298,303,308,315,319,324,327,331,334,337,341,344,348,352,358,362,366,371,376,381,386,392,,398,,,,,,],604:[358,363,368,375,379,384,387,391,394,397,401,404,408,412,418,422,426,431,436,441,446,452,,460,465,,,,,],606:[418,423,428,435,439,444,447,451,454,457,461,464,468,472,478,482,486,491,496,501,506,512,,518,,,,,,],608:[478,483,488,495,499,504,507,511,514,517,521,524,528,532,538,542,546,551,556,561,566,572,,580,585,,,,,],610:[538,543,548,555,559,563,567,570,574,577,581,584,588,592,598,602,606,611,616,621,626,632,,638,,,,,,],228:[598,603,608,615,619,624,627,631,634,637,641,644,648,652,658,662,666,671,676,681,686,692,,700,705,,,,,],632:[658,663,668,675,679,684,687,691,694,697,701,704,708,712,718,722,726,731,736,741,746,752,,758,,,,,,],636:[718,723,728,735,739,744,747,751,754,757,761,764,768,772,778,782,786,791,796,801,806,812,,820,825,,,,,],640:[778,783,788,795,799,804,807,811,814,817,821,824,828,832,838,842,846,851,856,861,866,872,,878,,,,,,],644:[838,843,848,855,859,864,867,871,874,877,881,884,888,892,898,902,906,911,916,921,926,932,,940,945,,,,,],248:[898,903,908,915,919,924,927,931,934,937,941,944,948,952,958,962,966,971,976,981,986,992,,1000,1005,,,,,],652:[958,963,968,975,979,984,987,991,994,997,1001,1004,1008,1012,1018,1022,1026,1031,1036,1041,1046,1052,,1060,1065,,,,,],656:[1018,1023,1028,1035,1039,1044,1047,1051,1054,1057,1061,1064,1068,1072,1078,1082,1086,1091,1096,1101,1106,1112,,1120,1125,1133,1139,1152,1158,1171],260:[1078,1083,1088,1095,1099,1104,1107,1111,1114,1117,1121,1124,1128,1132,1138,1142,1146,1151,1156,1161,1166,1172,,1178,,,,,,],264:[1138,1143,1148,1155,1159,1164,1167,1171,1174,1177,1181,1184,1188,1192,1198,1202,1206,1211,1216,1221,1226,1232,,1240,1245,,,,,],268:[1198,1203,1208,1215,1219,1224,1227,1231,1234,1237,1241,1244,1248,1252,1258,1262,1266,1271,1276,1281,1286,1292,,1298,,,,,,],272:[1258,1263,1268,1275,1279,1284,1287,1291,1294,1297,1301,1304,1308,1312,1318,1322,1326,1331,1336,1341,1346,1352,,1360,1365,,,,,],276:[1318,1323,1328,1335,1339,1344,1347,1351,1354,1357,1361,1364,1368,1372,1378,1382,1386,1391,1396,1401,1406,1412,,1418,,,,,,],280:[1378,1383,1388,1395,1399,1404,1407,1411,1414,1417,1421,1424,1428,1432,1438,1442,1446,1450,1455,1460,1465,1471,,1479,1484,,,,,],284:[1445,1450,1455,1462,1466,1471,1475,1478,1481,1485,1488,1492,1495,1499,1505,1509,1512,1517,1521,1526,1531,1537,,1544,1549,,,,,]},scheduleDate:1670257774000};
"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);Object.defineProperty(Constructor,"prototype",{writable:false});return Constructor}var special={"2022-11-24":1,"2022-11-25":2,"2022-12-24":1,"2022-12-25":1,"2022-12-26":1,"2022-12-31":1,"2023-01-01":1,"2023-01-02":1,"2023-01-16":2,"2023-02-23":2,"2023-05-29":1};var scheduleOptions=["Weekday","Weekend","Modified"];var CaltrainSchedule=function(){function CaltrainSchedule(goodTime){_classCallCheck(this,CaltrainSchedule);this.forToday=CaltrainSchedule.optionIndex(goodTime);this.selected=this.forToday}_createClass(CaltrainSchedule,[{key:"label",value:function label(){return scheduleOptions[this.selected]}},{key:"next",value:function next(){this.selected=this.selected>=scheduleOptions.length-1?0:this.selected+1}},{key:"swapped",value:function swapped(){return this.forToday!==this.selected}}],[{key:"optionIndex",value:function optionIndex(goodTime){if(goodTime.date in special){return special[goodTime.date]}else if(goodTime.dotw===0){return 2}else if(goodTime.dotw===6){return 1}else{return 0}}}]);return CaltrainSchedule}();
"use strict";function _createForOfIteratorHelper(o,allowArrayLike){var it=typeof Symbol!=="undefined"&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e2){didErr=true;err=_e2},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);Object.defineProperty(Constructor,"prototype",{writable:false});return Constructor}var CaltrainService=function(){function CaltrainService(){_classCallCheck(this,CaltrainService);this.northStops=CaltrainService.mapStops("North");this.southStops=CaltrainService.mapStops("South")}_createClass(CaltrainService,[{key:"stopMap",value:function stopMap(direction){return direction==="North"?this.northStops:this.southStops}},{key:"routes",value:function routes(departStop,arriveStop,schedule){var direction=CaltrainService.direction(departStop,arriveStop);var departTimes=this.times(departStop,direction,schedule);var arriveTimes=this.times(arriveStop,direction,schedule);var skip=[];return CaltrainService.merge(departTimes,arriveTimes,skip)}},{key:"times",value:function times(stop,direction,schedule){var source=CaltrainService.select(direction,schedule);var index=this.stopMap(direction).get(stop);var times=new Map;var _iterator=_createForOfIteratorHelper(Object.keys(source).map(Number)),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var train=_step.value;if(source[train][index])times.set(train,source[train][index])}}catch(err){_iterator.e(err)}finally{_iterator.f()}return times}}],[{key:"mapStops",value:function mapStops(direction){var out=new Map;var stops=direction==="North"?caltrainServiceData.northStops:caltrainServiceData.southStops;for(var i=0;i<stops.length;i++){out.set(stops[i],i)}return out}},{key:"tripStops",value:function tripStops(train,direction,schedule){var stops=direction==="North"?caltrainServiceData.northStops:caltrainServiceData.southStops;var times=CaltrainService.select(direction,schedule)[train];var out=[];for(var i=0;i<times.length;i++){if(times[i])out.push([stops[i],times[i]])}return out}},{key:"direction",value:function direction(departStop,arriveStop){var depart=caltrainServiceData.southStops.indexOf(departStop);var arrive=caltrainServiceData.southStops.indexOf(arriveStop);return depart<arrive?"South":"North"}},{key:"nextIndex",value:function nextIndex(routes,minutes){var index=0;var _iterator2=_createForOfIteratorHelper(routes),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var route=_step2.value;if(route[1]>minutes){return index}index++}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}return index}},{key:"merge",value:function merge(departTimes,arriveTimes,skip){var _iterator3=_createForOfIteratorHelper(skip),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var x=_step3.value;departTimes.delete(x)}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}var arr=[];var _iterator4=_createForOfIteratorHelper(departTimes.keys()),_step4;try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var train=_step4.value;if(arriveTimes.has(train)){arr.push([train,departTimes.get(train),arriveTimes.get(train)])}}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}var sorted=arr.sort(function(a,b){return a[1]-b[1]});return sorted}},{key:"select",value:function select(direction,schedule){if(schedule==="Modified"){return direction==="North"?caltrainServiceData.northModified:caltrainServiceData.southModified}else if(schedule==="Weekday"){return direction==="North"?caltrainServiceData.northWeekday:caltrainServiceData.southWeekday}else{return direction==="North"?caltrainServiceData.northWeekend:caltrainServiceData.southWeekend}}}]);return CaltrainService}();
"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);Object.defineProperty(Constructor,"prototype",{writable:false});return Constructor}var CaltrainTrip=function(){function CaltrainTrip(trip,schedule){_classCallCheck(this,CaltrainTrip);this.trip=trip;this.schedule=schedule;this.stops=[];this.times=[];this.direction=trip%2===0?"South":"North";this.setService()}_createClass(CaltrainTrip,[{key:"setService",value:function setService(){var mins=CaltrainService.tripStops(this.trip,this.direction,this.schedule);var strs=this.direction==="North"?caltrainServiceData.northStops:caltrainServiceData.southStops;this.times=[];this.stops=[];for(var i=0;i<mins.length;i++){if(mins[i]==undefined)continue;this.times.push(mins[i]);this.stops.push(strs[i])}}},{key:"label",value:function label(){return`${this.directionString()} #${this.trip} ${CaltrainTrip.type(this.trip)}`}},{key:"directionString",value:function directionString(){return this.direction[0]+"B"}}],[{key:"type",value:function type(trip){if(trip>900){return"Unknown"}else if(trip>700){return"Baby Bullet"}else if(trip>300){return"Limited"}else if(trip>100){return"Local"}else{return"Unknown"}}}]);return CaltrainTrip}();
"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);Object.defineProperty(Constructor,"prototype",{writable:false});return Constructor}var GoodTimes=function(){function GoodTimes(){_classCallCheck(this,GoodTimes);var now=new Date;var run=new Date(now.getTime()-2*60*60*1000);this.date=run.toJSON().slice(0,10);this.minutes=(run.getHours()+2)*60+run.getMinutes();this.seconds=run.getSeconds();this.dotw=run.getDay()}_createClass(GoodTimes,[{key:"partTime",value:function partTime(){return GoodTimes.partTime(this.minutes)}},{key:"fullTime",value:function fullTime(){return GoodTimes.fullTime(this.minutes)}},{key:"inThePast",value:function inThePast(target){return target-this.minutes<0}},{key:"departing",value:function departing(target){return target===this.minutes}},{key:"countdown",value:function countdown(target){var minutes=target-this.minutes-1;if(minutes<0){return""}else if(minutes>59){return`in ${Math.floor(minutes/60)} hr ${minutes%60} min`}else{return`in ${minutes} min ${60-this.seconds} sec`}}}],[{key:"partTime",value:function partTime(minutes){var hrs=Math.floor(minutes/60);var min=minutes%60;if(min<10){min="0"+min}var mer=hrs>11&&hrs<24?"pm":"am";if(hrs>12){hrs-=12;if(hrs>12){hrs-=12}}if(hrs<1){hrs=12}return[`${hrs}:${min}`,mer]}},{key:"fullTime",value:function fullTime(minutes){return GoodTimes.partTime(minutes).join("")}},{key:"dateString",value:function dateString(miliseconds){return new Date(miliseconds).toString().split(" ").slice(1,4).join(" ")}}]);return GoodTimes}();
"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);Object.defineProperty(Constructor,"prototype",{writable:false});return Constructor}var LocalStorage=function(){function LocalStorage(stations){_classCallCheck(this,LocalStorage);this.stations=stations;this.flipped=new Date().getHours()>=12;var savedAM=parseInt(localStorage.getItem("stopAM"));var savedPM=parseInt(localStorage.getItem("stopPM"));if(Number.isNaN(savedAM)||savedAM<0||savedAM>=stations.length){localStorage.setItem("stopAM",15)}if(Number.isNaN(savedAM)||savedPM<0||savedPM>=stations.length){localStorage.setItem("stopPM",0)}this.stopAM=parseInt(localStorage.getItem("stopAM"));this.stopPM=parseInt(localStorage.getItem("stopPM"))}_createClass(LocalStorage,[{key:"saveStops",value:function saveStops(){localStorage.setItem("stopAM",this.stopAM);localStorage.setItem("stopPM",this.stopPM)}},{key:"flipStations",value:function flipStations(){this.flipped=this.flipped?false:true}},{key:"tripLabels",value:function tripLabels(){this.origin=this.stations[this.flipped?this.stopPM:this.stopAM];this.destin=this.stations[this.flipped?this.stopAM:this.stopPM];if(this.origin.length+3>=this.destin.length){return[this.origin,`to ${this.destin}`]}else{return[`${this.origin} to`,this.destin]}}},{key:"bumpStations",value:function bumpStations(origin,increment){var max=this.stations.length-1;if(this.flipped)origin=!origin;if(origin&&!increment){this.stopAM=this.stopAM===max?0:++this.stopAM}else if(origin&&increment){this.stopAM=this.stopAM<1?max:--this.stopAM}else if(!origin&&!increment){this.stopPM=this.stopPM===max?0:++this.stopPM}else if(!origin&&increment){this.stopPM=this.stopPM<1?max:--this.stopPM}}}]);return LocalStorage}();
"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);Object.defineProperty(Constructor,"prototype",{writable:false});return Constructor}var prefs=new LocalStorage(caltrainServiceData.southStops);var service=new CaltrainService;var app=false;var android=false;var kaiWeb1=false;var kaiWeb2=false;var kaiWeb=false;var schedule=null;var countdown=null;var trainId=null;var offset=null;var goodTime=null;var skip=false;var splash=false;var hintIndex=-1;var menuIndex=0;var listing=null;var vh=228;var OK=13;var BACK=95;var HANGUP=8;var ESC=27;var UP=38;var DOWN=40;var screens="splash hero grid trip menu about commands prefs".split(" ");var titles={"about":"About Next Caltrain","commands":"Keypad commands"};var hints=[["Set your origin",[1,3],"Use [1] and [3] keys to<br/>set your origin station."],["Set destination",[4,6],"Use [4] and [6] keys to<br/>set destination station."],["Flip direction",["c"],"Press the [CALL] button to<br/>flip the selected stations"],["Change schedule",["l"],"Press the [LEFT] softkey<br/>to cycle through schedules."],["Save stations",["r"],"Press the [RIGHT] softkey<br/>and select \"Save Stations\"."],["Bookmark app",["r"],"Press the [RIGHT] softkey<br/>twice to \"Pin to Apps Menu\"."]];var NextCaltrain=function(){function NextCaltrain(){_classCallCheck(this,NextCaltrain)}_createClass(NextCaltrain,null,[{key:"startApp",value:function startApp(){if(document.location.search==="?app")app=true;else if(document.location.search==="?kaiWeb1"||navigator.userAgent.toLowerCase().indexOf("kaios/1")>-1)kaiWeb1=true;else if(document.location.search==="?kaiWeb2"||navigator.userAgent.toLowerCase().indexOf("kaios/2")>-1)kaiWeb2=true;kaiWeb=kaiWeb1||kaiWeb2;if(navigator.userAgent.toLowerCase().indexOf("android")>-1)android=true;if(!kaiWeb){document.getElementById("softkey-menu").style["display"]="flex";document.getElementById("about-filler").style["display"]="flex";document.getElementById("commands-filler").style["display"]="flex";document.getElementById("content").className="full-screen"}else{document.getElementById("content").className="part-screen";document.getElementById("hero-screen").style["display"]="none";document.getElementById("splash-screen").style["display"]="flex";splash=true}if(window.outerHeight>320&&!kaiWeb){document.getElementById("keypad").style["display"]="flex"}var dateString=GoodTimes.dateString(caltrainServiceData.scheduleDate);listing=document.getElementById("listing");document.getElementById("date-string").innerHTML=dateString;NextCaltrain.attachListeners();NextCaltrain.setTheTime();NextCaltrain.formatHints()}},{key:"formatHints",value:function formatHints(){if(!kaiWeb)hints=hints.slice(0,5);for(var i=0;i<hints.length;i++){for(var n=0;n<2;n++){hints[i][n*2]=hints[i][n*2].replace(/\[/g,"<span class='btn'>").replace(/\]/g,"</span>");if(kaiWeb1)hints[i][n*2]=hints[i][n*2].replace(/Apps Menu/,"Top Sites")}}}},{key:"bumpKeypadHint",value:function bumpKeypadHint(){hintIndex++;if(hintIndex>=hints.length){hintIndex=-1;NextCaltrain.displayScreen("hero");return}else if(hintIndex===hints.length-1){NextCaltrain.populateSoftkeyMenu("","OK","")}document.getElementById("hint-above").innerHTML=hints[hintIndex][0];document.getElementById("hint-below").innerHTML=hints[hintIndex][2];if(Array.isArray(hints[hintIndex][1])){document.getElementById("mini-keypad").style["display"]="flex";document.getElementById("hint-center").style["display"]="none";for(var i=1;i<15;i++){var key=i<10?i:["l","r","c","o","h"][i-10];var cls=hints[hintIndex][1].indexOf(key)===-1?"default":"selected";document.getElementById(`k${key}`).className=cls}}else{document.getElementById("mini-keypad").style["display"]="none";document.getElementById("hint-center").style["display"]="block";document.getElementById("hint-center").innerHTML=hints[hintIndex][1]}}},{key:"moveMenuSelection",value:function moveMenuSelection(){var menuOptions=document.getElementById("menu-list").getElementsByTagName("li");if(menuIndex>=menuOptions.length){menuIndex=0}else if(menuIndex<0){menuIndex=menuOptions.length-1}for(var i=0;i<menuOptions.length;i++){menuOptions[i].className=menuIndex===i?"selected":""}}},{key:"setTheTime",value:function setTheTime(){var ourTime=new GoodTimes;var partTime=ourTime.partTime();schedule=new CaltrainSchedule(ourTime);document.getElementById("time").innerHTML=partTime[0];document.getElementById("ampm").innerHTML=partTime[1].toUpperCase();setTimeout(function(){NextCaltrain.setTheTime()},(60-ourTime.seconds)*1000);NextCaltrain.loadSchedule()}},{key:"setCountdown",value:function setCountdown(minutes){var downTime=new GoodTimes;var blurb=downTime.countdown(minutes);document.getElementById("blurb-grid").innerHTML=blurb;document.getElementById("blurb-hero").innerHTML=blurb;if(blurb!==""){var refresh=blurb.endsWith("sec")?1000:(60-downTime.seconds)*1000;countdown=setTimeout(function(){NextCaltrain.setCountdown(minutes)},refresh)}}},{key:"populateStops",value:function populateStops(labels){document.getElementById("origin-grid").innerHTML=labels[0];document.getElementById("destin-grid").innerHTML=labels[1];document.getElementById("origin-hero").innerHTML=labels[0];document.getElementById("destin-hero").innerHTML=labels[1]}},{key:"populateBlurb",value:function populateBlurb(message,textClass){document.getElementById("blurb-grid").innerHTML=message;document.getElementById("blurb-grid").className=textClass;document.getElementById("blurb-hero").innerHTML=message.replace(" Schedule","");document.getElementById("blurb-hero").className=textClass}},{key:"populateSoftkeyMenu",value:function populateSoftkeyMenu(left,center,right){document.getElementById("softkey-left").innerHTML=left;document.getElementById("softkey-center").innerHTML=center;document.getElementById("softkey-right").innerHTML=right}},{key:"loadTrip",value:function loadTrip(train){goodTime=new GoodTimes;var trip=new CaltrainTrip(train,schedule.label());var lines=[];for(var i=0;i<trip.times.length;i++){var stop=trip.times[i];var spacer=i===0?"":"|";var fullTime=GoodTimes.fullTime(stop[1]);var filler=fullTime.length>6?"":"0";var style=goodTime.inThePast(stop[1])?"message-departed":"message-arriving";var target=prefs.origin===stop[0]||prefs.destin===stop[0]?"target":"";var bullet=android?"&#x2022;":"&#9679;";var dot_is=android?"android":"station";lines.push(`<div class="station-stop">
          <div class="station-time"><br/><span
               class="hour-filler">${filler}</span>${fullTime}</div>
          <div class="station-spacer ${style}">${spacer}<br/><span
               class="${dot_is}-dot ${target}">${bullet}</span></div>
          <div class="station-name"><br/>${stop[0]}</div></div>`)}listing.innerHTML=lines.join("\n");document.getElementById("trip-filler").innerHTML=trip.label();document.title=trip.label()}},{key:"loadSchedule",value:function loadSchedule(){goodTime=new GoodTimes;clearTimeout(countdown);NextCaltrain.populateStops(prefs.tripLabels());var routes=service.routes(prefs.origin,prefs.destin,schedule.label());var minutes=0;if(offset===null){minutes=goodTime.minutes;offset=CaltrainService.nextIndex(routes,minutes)}else if(offset>routes.length-1){offset=0}else if(offset<0){offset=routes.length-1}for(var i=0;i<6;i++){var tripCardElement=document.getElementById(`trip${i}`);var n=offset+i>routes.length-1?offset+i-routes.length:offset+i;var route=routes[n];if(i>routes.length-1){if(i===0){trainId=null;NextCaltrain.populateBlurb("NO TRAINS","message-departed blink");document.getElementById("circle").className="selection-departed";document.getElementById("trip0").className="selection-none";document.getElementById("trip").innerHTML="<span class=\"time-hero\">&nbsp;</span>";document.getElementById("trip-type").innerHTML="&nbsp;";document.getElementById("title").innerHTML="Next Caltrain";document.title="Next Caltrain"}tripCardElement.innerHTML="<div class=\"train-time\">&nbsp;</div>";continue}minutes=route[1];var originTime=GoodTimes.partTime(minutes);var destinTime=GoodTimes.partTime(route[2]);var card=`<div class="train-number">#${route[0]}</div>
          <div class="train-time">${originTime[0]}<span class="meridiem">${originTime[1]}</span></div>
          <div class="train-time">${destinTime[0]}<span class="meridiem">${destinTime[1]}</span></div>`;tripCardElement.innerHTML=card;if(i===0){var tripTime=`<span class="train-hero">#${route[0]}</span>
            <span class="time-hero">${originTime[0]}</span>
            <span class="meridiem-hero">${originTime[1]}</span>`;document.getElementById("trip").innerHTML=tripTime;trainId=route[0];var message=void 0,textClass=void 0,tripClass=void 0,wrapClass=void 0;if(schedule.swapped()){message=schedule.label()+" Schedule";textClass="message-departed";tripClass=goodTime.inThePast(minutes)?"message-departed":"";wrapClass="selection-departed"}else if(goodTime.inThePast(minutes)){message=schedule.label()+" Schedule";textClass="message-departed";tripClass="message-departed";wrapClass="selection-departed"}else if(goodTime.departing(minutes)){message="DEPARTING";textClass="message-departing blink";wrapClass="selection-departing"}else{message=goodTime.countdown(minutes);textClass="message-arriving";wrapClass="selection-arriving";if(minutes>0){NextCaltrain.setCountdown(minutes)}}document.getElementById("circle").className=wrapClass;document.getElementById("trip").className=tripClass;document.getElementById("trip-type").innerHTML=CaltrainTrip.type(trainId);if(trainId&&NextCaltrain.currentScreen()==="grid"){document.getElementById("title").innerHTML=`${CaltrainTrip.type(trainId)} Service`;document.title=`${CaltrainTrip.type(trainId)} Service`}tripCardElement.className=["trip-card","selection",tripClass,wrapClass].join(" ");NextCaltrain.populateBlurb(message,textClass)}else{if(goodTime.inThePast(minutes)){tripCardElement.className="trip-card message-departed"}else{tripCardElement.className="trip-card"}}}}},{key:"currentScreen",value:function currentScreen(){for(var i=0;i<screens.length;i++){if(document.getElementById(`${screens[i]}-screen`).style["display"]==="flex")return screens[i]}return screens[0]}},{key:"displayScreen",value:function displayScreen(target){for(var i=0;i<screens.length;i++){var display=target===screens[i]?"flex":"none";document.getElementById(`${screens[i]}-screen`).style["display"]=display}if(!kaiWeb){if(target==="hero"){NextCaltrain.populateSoftkeyMenu("","SELECT","Options")}else if(target==="grid"){NextCaltrain.populateSoftkeyMenu("","SELECT","Options")}else if(target==="trip"){NextCaltrain.populateSoftkeyMenu("","BACK","Options")}else if(target==="menu"){NextCaltrain.populateSoftkeyMenu("","SELECT","")}else if(target==="prefs"){NextCaltrain.populateSoftkeyMenu("Cancel","","OK")}else if(target==="about"){NextCaltrain.populateSoftkeyMenu("","OK","")}else if(target==="commands"){NextCaltrain.populateSoftkeyMenu("","NEXT","")}}document.getElementById("title").innerHTML="Next Caltrain";document.title=target in titles?titles[target]:"Next Caltrain";if(target==="grid"||target==="hero"){NextCaltrain.loadSchedule()}}},{key:"attachListeners",value:function attachListeners(){document.addEventListener("DOMContentLoaded",function(){if(app&&navigator.userAgent.toLowerCase().indexOf("kaios/2")>-1){getKaiAd({publisher:"8400043d-1768-4179-8a02-6bc7f7e62a25",app:"NextCaltrain",slot:"mainAdUnit",test:0,onerror:function onerror(err){return console.error("Custom catch:",err)},onready:function onready(ad){ad.call("display")}})}});document.addEventListener("touchstart",function(e){var code=null;if(e.target.id==="softkey-center"){code=OK}else if(e.target.id==="softkey-left"){code="sl"}else if(e.target.id==="softkey-right"){code="sr"}else if(e.target.getAttribute("value")==="about"){code="about"}else if(e.target.getAttribute("value")==="commands"){code="commands"}else if(e.target.getAttribute("value")==="prefs"){code="prefs"}else{return}NextCaltrain.press(code)});document.addEventListener("mousemove",function(e){if(!kaiWeb)return;skip=skip?false:true;if(kaiWeb&&splash&&e.clientX>=239){splash=false;NextCaltrain.displayScreen("hero")}else if(kaiWeb&&!splash&&e.clientX<239){splash=true;NextCaltrain.displayScreen("splash")}else if(e.mozMovementY>0){NextCaltrain.press(DOWN);if(skip){NextCaltrain.press(DOWN);skip=false}}else if(e.mozMovementY<0){NextCaltrain.press(UP);if(skip){NextCaltrain.press(UP);skip=false}}else if(e.mozMovementX===0&&!skip){if(e.clientY===0){NextCaltrain.press(UP)}else if(e.clientY>=vh-1){NextCaltrain.press(DOWN)}}});document.addEventListener("click",function(){if(kaiWeb){NextCaltrain.press(OK)}});document.addEventListener("keydown",function(e){var code=e.keyCode?e.keyCode:e.which;if(code===HANGUP){code=BACK;if(NextCaltrain.currentScreen()!=="hero"){e.preventDefault()}else{return}}else if(e.key==="Call"||code===220){code="call"}else if(e.key==="SoftLeft"||e.key==="["){code="sl";e.preventDefault()}else if(e.key==="SoftRight"||e.key==="]"){code="sr";if(NextCaltrain.currentScreen()!=="menu")e.preventDefault()}else if(e.key==="1"||e.key==="3"){e.preventDefault()}else if(e.key==="2"){e.preventDefault()}else if(code===OK){e.preventDefault()}NextCaltrain.press(code)})}},{key:"press",value:function press(code){if(splash)return;if(code===ESC){NextCaltrain.displayScreen("hero")}else if(code==="prefs"){var confirmation=["Save",prefs.flipped?prefs.destin:prefs.origin,"as morning and",prefs.flipped?prefs.origin:prefs.destin,"as evening default stations?"].join(" ");document.getElementById("confirmation").innerHTML=confirmation;NextCaltrain.displayScreen("prefs")}else if(code==="about"){NextCaltrain.displayScreen("about")}else if(code==="commands"){NextCaltrain.bumpKeypadHint();NextCaltrain.displayScreen("commands")}else if(NextCaltrain.currentScreen()==="about"){if(code===OK||code===BACK){NextCaltrain.displayScreen("hero")}}else if(NextCaltrain.currentScreen()==="commands"){if(code===OK){NextCaltrain.bumpKeypadHint()}else if(code===BACK){hintIndex=-1;NextCaltrain.displayScreen("hero")}}else if(NextCaltrain.currentScreen()==="prefs"){if(kaiWeb&&code===OK||!kaiWeb&&code==="sr"){prefs.saveStops();NextCaltrain.displayScreen("hero")}else if(kaiWeb&&code===BACK||!kaiWeb&&code==="sl"){NextCaltrain.displayScreen("hero")}}else if(NextCaltrain.currentScreen()==="menu"){if(code===OK){var menuOptions=document.getElementById("menu-list").getElementsByTagName("li");var action=menuOptions[menuIndex].getAttribute("value");menuIndex=0;NextCaltrain.press(action)}else if(code===UP){menuIndex--}else if(code===DOWN){menuIndex++}else if(code===BACK){menuIndex=0;NextCaltrain.displayScreen("hero")}NextCaltrain.moveMenuSelection()}else if(code==="sr"){menuIndex=0;NextCaltrain.displayScreen("menu")}else if(NextCaltrain.currentScreen()==="trip"){if(code===OK||code===BACK){NextCaltrain.displayScreen("grid")}else if(code===UP){if(listing.scrollTop>0)listing.scrollTo(0,listing.scrollTop-72)}else if(code===DOWN){if(listing.scrollTop<listing.scrollHeight-228)listing.scrollTo(0,listing.scrollTop+72)}}else if(code===OK&&NextCaltrain.currentScreen()==="grid"&&trainId!==null){NextCaltrain.displayScreen("trip");NextCaltrain.loadTrip(trainId)}else{if(code===BACK){NextCaltrain.displayScreen("hero")}else if(code===OK){NextCaltrain.displayScreen("grid")}else if(code===UP){offset--}else if(code===DOWN){offset++}else if(code===49||code===55){offset=null;prefs.bumpStations(true,false)}else if(code===51||code===57){offset=null;prefs.bumpStations(true,true)}else if(code===52){offset=null;prefs.bumpStations(false,false)}else if(code===54){offset=null;prefs.bumpStations(false,true)}else if(code==="call"){offset=null;prefs.flipStations()}else if(code==="sl"){schedule.next();offset=null}else{return}NextCaltrain.loadSchedule()}}}]);return NextCaltrain}();
