'use strict';var caltrainServiceData={northStops:['Gilroy','San Martin','Morgan Hill','Blossom Hill','Capitol','Tamien','San Jose Diridon','College Park','Santa Clara','Lawrence','Sunnyvale','Mountain View','San Antonio','California Ave','Palo Alto','Menlo Park','Atherton','Redwood City','San Carlos','Belmont','Hillsdale','Hayward Park','San Mateo','Burlingame','Broadway','Millbrae','San Bruno','So San Francisco','Bayshore','22nd Street','San Francisco'],northWeekday:{101:[,,,,,,268,,274,280,284,289,293,297,301,304,,310,315,318,,325,328,332,,337,341,345,352,357,363],103:[,,,,,296,303,,309,315,319,324,328,332,336,339,,345,350,353,,360,363,367,,372,376,380,387,392,398],205:[,,,,,347,354,,,364,,372,,379,384,,,,393,396,,,,405,,411,,418,,,431],207:[,,,,,360,367,,373,,382,,388,,396,399,,406,,412,,,420,,,427,432,,,444,450],113:[,,,,,379,386,,392,398,402,408,411,416,420,424,,429,434,437,,445,449,452,,457,462,466,472,478,484],215:[363,372,378,394,400,407,414,,,424,,432,,439,444,,,,453,456,,,,465,,471,,478,,,491],217:[,,,,,418,427,,433,,442,,448,,456,459,,466,,472,,,480,,,487,492,,,504,510],123:[393,402,408,423,429,436,444,448,452,458,462,468,471,476,480,484,,489,494,497,,505,509,512,,517,522,526,532,538,544],225:[,,,,,467,474,,,484,,492,,499,504,,,,513,516,,,,525,,531,,538,,,551],227:[,,,,,,487,,493,,502,,508,,516,519,,526,,532,,,540,,,547,552,,,564,570],133:[,,,,,499,506,,512,518,522,528,531,536,540,544,,549,554,557,,565,569,572,,577,582,586,592,598,604],235:[,,,,,,534,,,544,,552,,559,564,,,,573,576,,,,585,,591,,598,,,611],237:[,,,,,540,547,,553,,562,,568,,576,579,,586,,592,,,600,,,607,612,,,624,629],139:[,,,,,,560,,566,572,576,582,585,590,594,598,,605,611,616,,624,629,632,,638,642,646,652,658,664],141:[,,,,,583,590,,596,602,607,612,616,620,625,629,,635,640,643,,651,656,660,,665,670,674,681,687,693],143:[,,,,,,650,,656,662,666,672,676,680,685,689,,695,700,703,,711,716,719,,725,730,734,741,747,752],145:[,,,,,,710,,716,722,726,732,736,740,745,749,,755,760,763,,771,776,779,,785,790,794,801,807,812],147:[,,,,,,770,,776,782,786,792,796,800,805,809,,815,820,823,,831,836,839,,845,850,854,861,867,872],151:[,,,,,,830,,836,842,846,852,856,860,865,869,,875,880,883,,891,896,899,,905,910,914,921,927,932],155:[,,,,,,890,,896,902,906,912,916,920,925,929,,935,939,942,,950,954,958,,963,968,972,979,985,991],159:[,,,,,,920,924,927,933,938,943,947,953,959,964,,972,976,980,,987,991,995,,1000,1004,1008,1014,1020,1026],261:[,,,,,945,951,,958,,967,,973,,981,984,,,,993,,,1000,,,1008,1013,1017,,,1030],263:[,,,,,,967,,,977,,985,,992,997,,,1004,1009,1013,,,,1022,,1028,,,,1044,1049],169:[,,,,,,985,,991,997,1001,1007,1011,1015,1020,1023,,1029,1034,1038,,1045,1049,1053,,1058,1063,1067,1074,1080,1085],271:[,,,,,1005,1011,,1018,,1027,,1033,,1041,1044,,,,1053,,,1060,,,1068,1073,1077,,,1090],273:[,,,,,,1027,,,1037,,1045,,1052,1057,,,1064,1069,1073,,,,1082,,1088,,,,1104,1109],179:[,,,,,,1045,,1051,1057,1061,1067,1071,1075,1080,1083,,1089,1094,1098,,1105,1109,1113,,1118,1123,1127,1134,1140,1145],281:[,,,,,,1072,,1078,,1087,,1093,,1101,1104,,,,1113,,,1121,,,1128,1133,1137,,,1151],283:[,,,,,1080,1087,,,1097,,1105,,1112,1117,,,1124,1129,1133,,,,1142,,1148,,,,1164,1169],189:[,,,,,,1105,,1111,1117,1121,1127,1131,1135,1140,1143,,1149,1154,1158,,1165,1169,1173,,1178,1183,1187,1194,1200,1205],191:[,,,,,1122,1129,,1135,1141,1146,1151,1155,1159,1164,1168,,1174,1180,1184,,1192,1197,1201,,1206,1211,1215,1221,1227,1233],193:[,,,,,,1183,,1189,1195,1200,1206,1210,1215,1221,1226,,1233,1237,1241,,1249,1253,1257,,1263,1268,1272,1278,1284,1290],195:[,,,,,1243,1250,,1256,1262,1266,1272,1276,1280,1285,1289,,1295,1300,1303,,1311,1316,1319,,1325,1330,1334,1341,1347,1352],197:[,,,,,1303,1310,,1316,1322,1326,1332,1336,1340,1345,1349,,1355,1360,1363,,1371,1376,1379,,1385,1390,1394,1401,1407,1412],199:[,,,,,,1350,,1356,1362,1366,1371,1375,1379,1383,1386,,1392,1397,1400,,1407,1410,1414,,1419,1423,1427,1434,1439,1445]},northWeekend:{421:[,,,,,,428,,433,439,443,449,453,457,462,465,469,473,478,482,,489,492,496,500,503,508,513,519,525,532],423:[,,,,,,518,,523,529,533,539,543,547,552,555,559,563,568,572,,579,582,586,590,593,598,603,609,615,622],801:[,,,,,,591,,,,601,606,,,613,,,620,,626,,,632,,,640,,,,,660],425:[,,,,,,608,,613,619,623,629,633,637,642,645,649,653,658,662,,669,672,676,680,683,688,693,699,705,712],427:[,,,,,,698,,703,709,713,719,723,727,732,735,739,743,748,752,,759,762,766,770,773,778,783,789,795,802],429:[,,,,,,788,,793,799,803,809,813,817,822,825,829,833,838,842,,849,852,856,860,863,868,873,879,885,892],431:[,,,,,,878,,883,889,893,899,903,907,912,915,919,923,928,932,,939,942,946,950,953,958,963,969,975,982],433:[,,,,,,968,,973,979,983,989,993,997,1002,1005,1009,1013,1018,1022,,1029,1032,1036,1040,1043,1048,1053,1059,1065,1072],803:[,,,,,,1041,,,,1051,1056,,,1063,,,1070,,1076,,,1082,,,1090,,,,,1110],435:[,,,,,,1058,,1063,1069,1073,1079,1083,1087,1092,1095,1099,1103,1108,1112,,1119,1122,1126,1130,1133,1138,1143,1149,1155,1162],437:[,,,,,,1148,,1153,1159,1163,1169,1173,1177,1182,1185,1189,1193,1198,1202,,1209,1212,1216,1220,1223,1228,1233,1239,1245,1252],439:[,,,,,,1238,,1243,1249,1253,1259,1263,1267,1272,1275,1279,1283,1288,1292,,1299,1302,1306,1310,1313,1318,1323,1329,1335,1342],441:[,,,,,,1328,,1333,1339,1343,1349,1353,1357,1362,1365,1369,1373,1378,1382,,1389,1392,1396,1400,1403,1408,1413,1419,1425,1432],443:[,,,,,,1350,,1355,1360,1364,1369,1373,1377,1381,1384,1388,1392,1397,1401,,1408,1411,1415,1419,1422,1427,1432,1438,1443,1454]},southStops:['San Francisco','22nd Street','Bayshore','So San Francisco','San Bruno','Millbrae','Broadway','Burlingame','San Mateo','Hayward Park','Hillsdale','Belmont','San Carlos','Redwood City','Atherton','Menlo Park','Palo Alto','California Ave','San Antonio','Mountain View','Sunnyvale','Lawrence','Santa Clara','College Park','San Jose Diridon','Tamien','Capitol','Blossom Hill','Morgan Hill','San Martin','Gilroy'],southWeekday:{102:[291,296,301,308,312,316,,321,325,328,,335,339,343,,349,353,356,361,365,370,374,380,,387,,,,,,],104:[325,330,335,342,346,350,,355,359,362,,369,373,377,,383,387,390,395,399,404,409,415,,424,429,,,,,],206:[360,,,373,377,,,,387,,,394,,400,,406,411,,417,422,428,,436,,445,450,,,,,],208:[372,378,,,,393,,399,,,,407,411,416,,,424,428,,435,,443,,,453,,,,,,],114:[393,398,404,410,414,419,,424,427,431,,438,442,447,,453,457,460,465,470,475,479,485,488,493,,,,,,],216:[420,,,433,437,,,,446,,,453,,460,,466,470,,476,481,488,,495,,502,,,,,,],218:[432,438,,,,453,,459,,,,467,471,476,,,484,488,,496,,503,,,515,520,,,,,],124:[453,458,464,470,474,479,,484,487,491,,498,502,507,,513,517,520,525,530,535,539,545,,551,,,,,,],226:[480,,,493,497,,,,506,,,513,,520,,526,530,,536,541,548,,555,,562,,,,,,],228:[492,498,,,,513,,519,,,,527,531,536,,,544,548,,556,,563,,,574,,,,,,],134:[513,518,524,530,534,539,,544,547,551,,558,562,567,,575,579,583,587,592,597,602,607,,614,,,,,,],236:[552,558,,,,573,,580,,,,590,594,599,,,608,612,,620,,628,,,640,645,,,,,],138:[575,580,585,592,596,601,,606,610,614,,621,625,630,,636,641,644,649,654,659,664,670,,678,683,,,,,],140:[635,640,645,652,656,661,,666,670,674,,681,685,690,,696,701,704,709,714,719,724,730,,738,743,,,,,],142:[695,700,705,712,716,721,,726,730,734,,741,745,750,,756,761,764,769,774,779,784,790,,796,,,,,,],144:[755,760,765,772,776,781,,786,790,794,,801,805,810,,816,821,824,829,834,839,844,850,,856,,,,,,],146:[815,820,825,832,836,841,,846,850,854,,861,865,870,,876,881,884,889,894,899,904,910,,916,,,,,,],148:[875,880,885,892,896,901,,906,910,914,,921,925,930,,936,941,944,949,954,959,964,970,,976,,,,,,],150:[915,921,926,932,936,941,,946,950,953,,961,964,969,,975,979,983,988,993,998,1003,1009,1012,1019,1026,1033,1039,1052,1058,1071],252:[955,,,968,,977,,984,,,,995,998,,,,1008,1013,,1020,,1029,,,1041,1046,,,,,],254:[972,978,,,990,995,,,1003,,,1010,,1017,,1023,1028,,1034,,1042,,1050,,1056,,,,,,],160:[995,1001,1006,1012,1016,1021,,1026,1030,1033,,1041,1044,1049,,1055,1059,1063,1067,1072,1077,1082,1087,,1096,1101,,,,,],262:[1020,,,1033,,1040,,1046,,,,1055,1058,,,,1069,1074,,1082,,1091,,,1104,1111,1119,1125,1138,1145,1158],264:[1032,1038,,,1050,1055,,,1063,,,1070,,1077,,1083,1088,,1094,,1102,,1110,,1116,,,,,,],170:[1053,1059,1065,1071,1075,1080,,1085,1089,1092,,1100,1103,1108,,1114,1118,1122,1126,1131,1136,1140,1146,,1154,1159,,,,,],272:[1080,,,1093,,1100,,1106,,,,1115,1118,,,,1128,1133,,1140,,1149,,,1159,,,,,,],274:[1092,1098,,,1110,1115,,,1123,,,1130,,1137,,1143,1148,,1154,,1162,,1170,,1178,1183,,,,,],180:[1113,1119,1125,1131,1135,1140,,1145,1149,1152,,1160,1163,1168,,1174,1178,1182,1186,1191,1196,1200,1206,,1212,,,,,,],282:[1140,,,1153,,1160,,1166,,,,1174,1178,,,,1188,1192,,1199,,1207,,,1217,,,,,,],284:[1152,1158,,,1170,1176,,,1183,,,1190,,1196,,1202,1207,,1213,,1221,,1229,,1235,,,,,,],190:[1175,1180,1185,1192,1196,1201,,1206,1210,1213,,1221,1224,1230,,1236,1240,1244,1249,1253,1259,1263,1269,,1276,,,,,,],192:[1235,1240,1245,1252,1256,1261,,1266,1270,1274,,1281,1285,1290,,1296,1301,1304,1309,1314,1319,1324,1330,,1338,1343,,,,,],194:[1295,1300,1305,1312,1316,1321,,1326,1330,1334,,1341,1345,1350,,1356,1361,1364,1369,1374,1379,1384,1390,,1398,1403,,,,,],196:[1355,1360,1365,1372,1376,1380,,1385,1389,1392,,1399,1403,1407,,1413,1417,1420,1425,1429,1434,1438,1444,,1451,,,,,,]},southWeekend:{422:[487,491,498,504,510,514,518,521,525,528,,536,539,544,549,552,556,560,564,569,574,578,584,,592,,,,,,],424:[577,581,588,594,600,604,608,611,615,618,,626,629,634,639,642,646,650,654,659,664,668,674,,682,,,,,,],426:[667,671,678,684,690,694,698,701,705,708,,716,719,724,729,732,736,740,744,749,754,758,764,,772,,,,,,],802:[724,,,,,739,,,746,,,752,,758,,,765,,,774,780,,,,793,,,,,,],428:[757,761,768,774,780,784,788,791,795,798,,806,809,814,819,822,826,830,834,839,844,848,854,,862,,,,,,],430:[847,851,858,864,870,874,878,881,885,888,,896,899,904,909,912,916,920,924,929,934,938,944,,952,,,,,,],432:[937,941,948,954,960,964,968,971,975,978,,986,989,994,999,1002,1006,1010,1014,1019,1024,1028,1034,,1042,,,,,,],434:[1027,1031,1038,1044,1050,1054,1058,1061,1065,1068,,1076,1079,1084,1089,1092,1096,1100,1104,1109,1114,1118,1124,,1132,,,,,,],436:[1117,1121,1128,1134,1140,1144,1148,1151,1155,1158,,1166,1169,1174,1179,1182,1186,1190,1194,1199,1204,1208,1214,,1222,,,,,,],804:[1174,,,,,1189,,,1196,,,1202,,1208,,,1215,,,1224,1230,,,,1243,,,,,,],438:[1207,1211,1218,1224,1230,1234,1238,1241,1245,1248,,1256,1259,1264,1269,1272,1276,1280,1284,1289,1294,1298,1304,,1312,,,,,,],440:[1297,1301,1308,1314,1320,1324,1328,1331,1335,1338,,1346,1349,1354,1359,1362,1366,1370,1374,1379,1384,1388,1394,,1402,,,,,,],442:[1370,1374,1381,1387,1392,1396,1401,1404,1408,1411,,1419,1422,1427,1432,1435,1439,1443,1447,1452,1457,1461,1467,,1475,,,,,,],444:[1445,1450,1455,1461,1465,1469,1473,1475,1481,1484,,1492,1495,1501,1505,1508,1511,1515,1519,1523,1528,1532,1537,,1545,,,,,,]},scheduleDate:1592005502000};
'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value'in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var special={'2020-05-25':2};var scheduleOptions=['Weekday','Saturday','Sunday'];var CaltrainSchedule=function(){function CaltrainSchedule(goodTime){_classCallCheck(this,CaltrainSchedule);this.forToday=CaltrainSchedule.optionIndex(goodTime);this.selected=this.forToday}_createClass(CaltrainSchedule,[{key:'label',value:function label(){return scheduleOptions[this.selected]}},{key:'next',value:function next(){this.selected=this.selected>=scheduleOptions.length-1?0:this.selected+1}},{key:'swapped',value:function swapped(){return this.forToday!==this.selected}}],[{key:'optionIndex',value:function optionIndex(goodTime){if(goodTime.date in special){return special[goodTime.date]}else if(goodTime.dotw===0){return 2}else if(goodTime.dotw===6){return 1}else{return 0}}}]);return CaltrainSchedule}();
'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value'in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var saturdayTripIds=[421,443,442,444];var CaltrainService=function(){function CaltrainService(){_classCallCheck(this,CaltrainService);this.northStops=CaltrainService.mapStops('North');this.southStops=CaltrainService.mapStops('South')}_createClass(CaltrainService,[{key:'stopMap',value:function stopMap(direction){return direction==='North'?this.northStops:this.southStops}},{key:'routes',value:function routes(departStop,arriveStop,schedule){var direction=CaltrainService.direction(departStop,arriveStop);var departTimes=this.times(departStop,direction,schedule);var arriveTimes=this.times(arriveStop,direction,schedule);var skip=schedule==='Sunday'?saturdayTripIds:[];return CaltrainService.merge(departTimes,arriveTimes,skip)}},{key:'times',value:function times(stop,direction,schedule){var source=CaltrainService.select(direction,schedule);var index=this.stopMap(direction).get(stop);var times=new Map;var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=Object.keys(source).map(Number)[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var train=_step.value;if(source[train][index])times.set(train,source[train][index])}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}return times}}],[{key:'mapStops',value:function mapStops(direction){var out=new Map;var stops=direction==='North'?caltrainServiceData.northStops:caltrainServiceData.southStops;for(var i=0;i<stops.length;i++){out.set(stops[i],i)}return out}},{key:'tripStops',value:function tripStops(train,direction,schedule){var stops=direction==='North'?caltrainServiceData.northStops:caltrainServiceData.southStops;var times=CaltrainService.select(direction,schedule)[train];var out=[];for(var i=0;i<times.length;i++){if(times[i])out.push([stops[i],times[i]])}return out}},{key:'direction',value:function direction(departStop,arriveStop){var depart=caltrainServiceData.southStops.indexOf(departStop);var arrive=caltrainServiceData.southStops.indexOf(arriveStop);return depart<arrive?'South':'North'}},{key:'nextIndex',value:function nextIndex(routes,minutes){var index=0;var _iteratorNormalCompletion2=true;var _didIteratorError2=false;var _iteratorError2=undefined;try{for(var _iterator2=routes[Symbol.iterator](),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=true){var route=_step2.value;if(route[1]>minutes){return index}index++}}catch(err){_didIteratorError2=true;_iteratorError2=err}finally{try{if(!_iteratorNormalCompletion2&&_iterator2.return){_iterator2.return()}}finally{if(_didIteratorError2){throw _iteratorError2}}}return index}},{key:'merge',value:function merge(departTimes,arriveTimes,skip){var _iteratorNormalCompletion3=true;var _didIteratorError3=false;var _iteratorError3=undefined;try{for(var _iterator3=skip[Symbol.iterator](),_step3;!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=true){var x=_step3.value;departTimes.delete(x)}}catch(err){_didIteratorError3=true;_iteratorError3=err}finally{try{if(!_iteratorNormalCompletion3&&_iterator3.return){_iterator3.return()}}finally{if(_didIteratorError3){throw _iteratorError3}}}var arr=[];var _iteratorNormalCompletion4=true;var _didIteratorError4=false;var _iteratorError4=undefined;try{for(var _iterator4=departTimes.keys()[Symbol.iterator](),_step4;!(_iteratorNormalCompletion4=(_step4=_iterator4.next()).done);_iteratorNormalCompletion4=true){var train=_step4.value;if(arriveTimes.has(train)){arr.push([train,departTimes.get(train),arriveTimes.get(train)])}}}catch(err){_didIteratorError4=true;_iteratorError4=err}finally{try{if(!_iteratorNormalCompletion4&&_iterator4.return){_iterator4.return()}}finally{if(_didIteratorError4){throw _iteratorError4}}}var sorted=arr.sort(function(a,b){return a[1]-b[1]});return sorted}},{key:'select',value:function select(direction,schedule){if(schedule==='Modified'){return direction==='North'?caltrainServiceData.northModified:caltrainServiceData.southModified}else if(schedule==='Weekday'){return direction==='North'?caltrainServiceData.northWeekday:caltrainServiceData.southWeekday}else{return direction==='North'?caltrainServiceData.northWeekend:caltrainServiceData.southWeekend}}}]);return CaltrainService}();
'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value'in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var CaltrainTrip=function(){function CaltrainTrip(trip,schedule){_classCallCheck(this,CaltrainTrip);this.trip=trip;this.schedule=schedule;this.stops=[];this.times=[];this.direction=trip%2===0?'South':'North';this.setService()}_createClass(CaltrainTrip,[{key:'setService',value:function setService(){var mins=CaltrainService.tripStops(this.trip,this.direction,this.schedule);var strs=this.direction==='North'?caltrainServiceData.northStops:caltrainServiceData.southStops;this.times=[];this.stops=[];for(var i=0;i<mins.length;i++){if(mins[i]==undefined)continue;this.times.push(mins[i]);this.stops.push(strs[i])}}},{key:'label',value:function label(){return`${this.directionString()} #${this.trip} ${CaltrainTrip.type(this.trip)}`}},{key:'directionString',value:function directionString(){return this.direction[0]+'B'}}],[{key:'type',value:function type(trip){if(trip>900){return'Unknown'}else if(trip>800){return'Baby Bullet'}else if(trip>500){return'Limited'}else if(trip>400){return'Local'}else if(trip>300){return'Baby Bullet'}else if(trip>200){return'Limited'}else if(trip>100){return'Local'}else{return'Unknown'}}}]);return CaltrainTrip}();
'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value'in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var GoodTimes=function(){function GoodTimes(){_classCallCheck(this,GoodTimes);var now=new Date;var run=new Date(now.getTime()-2*60*60*1000);this.date=run.toJSON().slice(0,10);this.minutes=(run.getHours()+2)*60+run.getMinutes();this.seconds=run.getSeconds();this.dotw=run.getDay()}_createClass(GoodTimes,[{key:'partTime',value:function partTime(){return GoodTimes.partTime(this.minutes)}},{key:'fullTime',value:function fullTime(){return GoodTimes.fullTime(this.minutes)}},{key:'inThePast',value:function inThePast(target){return target-this.minutes<0}},{key:'departing',value:function departing(target){return target===this.minutes}},{key:'countdown',value:function countdown(target){var minutes=target-this.minutes-1;if(minutes<0){return''}else if(minutes>59){return`in ${Math.floor(minutes/60)} hr ${minutes%60} min`}else{return`in ${minutes} min ${60-this.seconds} sec`}}}],[{key:'partTime',value:function partTime(minutes){var hrs=Math.floor(minutes/60);var min=minutes%60;if(min<10){min='0'+min}var mer=hrs>11&&hrs<24?'pm':'am';if(hrs>12){hrs-=12;if(hrs>12){hrs-=12}}if(hrs<1){hrs=12}return[`${hrs}:${min}`,mer]}},{key:'fullTime',value:function fullTime(minutes){return GoodTimes.partTime(minutes).join('')}},{key:'dateString',value:function dateString(miliseconds){return new Date(miliseconds).toString().split(' ').slice(1,4).join(' ')}}]);return GoodTimes}();
'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value'in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var LocalStorage=function(){function LocalStorage(stations){_classCallCheck(this,LocalStorage);this.stations=stations;this.flipped=new Date().getHours()>=12;var savedAM=parseInt(localStorage.getItem('stopAM'));var savedPM=parseInt(localStorage.getItem('stopPM'));if(Number.isNaN(savedAM)||savedAM<0||savedAM>=stations.length){localStorage.setItem('stopAM',16)}if(Number.isNaN(savedAM)||savedPM<0||savedPM>=stations.length){localStorage.setItem('stopPM',0)}this.stopAM=parseInt(localStorage.getItem('stopAM'));this.stopPM=parseInt(localStorage.getItem('stopPM'))}_createClass(LocalStorage,[{key:'saveStops',value:function saveStops(){localStorage.setItem('stopAM',this.stopAM);localStorage.setItem('stopPM',this.stopPM)}},{key:'flipStations',value:function flipStations(){this.flipped=this.flipped?false:true}},{key:'tripLabels',value:function tripLabels(){this.origin=this.stations[this.flipped?this.stopPM:this.stopAM];this.destin=this.stations[this.flipped?this.stopAM:this.stopPM];if(this.origin.length+3>=this.destin.length){return[this.origin,`to ${this.destin}`]}else{return[`${this.origin} to`,this.destin]}}},{key:'bumpStations',value:function bumpStations(origin,increment){var max=this.stations.length-1;if(this.flipped)origin=!origin;if(origin&&!increment){this.stopAM=this.stopAM===max?0:++this.stopAM}else if(origin&&increment){this.stopAM=this.stopAM<1?max:--this.stopAM}else if(!origin&&!increment){this.stopPM=this.stopPM===max?0:++this.stopPM}else if(!origin&&increment){this.stopPM=this.stopPM<1?max:--this.stopPM}}}]);return LocalStorage}();
'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value'in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var prefs=new LocalStorage(caltrainServiceData.southStops);var service=new CaltrainService;var app=false;var kaiWeb1=false;var kaiWeb2=false;var kaiWeb=false;var schedule=null;var countdown=null;var trainId=null;var offset=null;var goodTime=null;var skip=false;var splash=false;var hintIndex=-1;var menuIndex=0;var listing=null;var vh=228;var OK=13;var BACK=95;var HANGUP=8;var ESC=27;var UP=38;var DOWN=40;var SPLAT=170;var screens='splash hero grid trip menu about commands prefs'.split(' ');var titles={'about':'About Next Caltrain','commands':'Keypad commands'};var hints=[['Set your origin',[1,3],'Use [1] and [3] keys to<br/>set your origin station.'],['Set destination',[4,6],'Use [4] and [6] keys to<br/>set destination station.'],['Flip direction',['c'],'Press the [CALL] button to<br/>flip the selected stations'],['Change schedule',['l'],'Press the [LEFT] softkey<br/>to cycle through schedules.'],['Save stations',['r'],'Press the [RIGHT] softkey<br/>and select "Save Stations".'],['Bookmark app',['r'],'Press the [RIGHT] softkey<br/>twice to "Pin to Apps Menu".']];var NextCaltrain=function(){function NextCaltrain(){_classCallCheck(this,NextCaltrain)}_createClass(NextCaltrain,null,[{key:'startApp',value:function startApp(){if(document.location.search==='?app')app=true;else if(document.location.search==='?kaiWeb1'||navigator.userAgent.toLowerCase().indexOf('kaios/1')>-1)kaiWeb1=true;else if(document.location.search==='?kaiWeb2'||navigator.userAgent.toLowerCase().indexOf('kaios/2')>-1)kaiWeb2=true;kaiWeb=kaiWeb1||kaiWeb2;if(!kaiWeb){document.getElementById('softkey-menu').style['display']='flex';document.getElementById('about-filler').style['display']='flex';document.getElementById('commands-filler').style['display']='flex';document.getElementById('content').className='full-screen'}else{document.getElementById('content').className='part-screen';document.getElementById('hero-screen').style['display']='none';document.getElementById('splash-screen').style['display']='flex';splash=true}if(window.outerHeight>320&&!kaiWeb){document.getElementById('keypad').style['display']='flex'}var dateString=GoodTimes.dateString(caltrainServiceData.scheduleDate);listing=document.getElementById('listing');document.getElementById('date-string').innerHTML=dateString;NextCaltrain.attachListeners();NextCaltrain.setTheTime();NextCaltrain.formatHints()}},{key:'formatHints',value:function formatHints(){if(!kaiWeb)hints=hints.slice(0,5);for(var i=0;i<hints.length;i++){for(var n=0;n<2;n++){hints[i][n*2]=hints[i][n*2].replace(/\[/g,'<span class=\'btn\'>').replace(/\]/g,'</span>');if(kaiWeb1)hints[i][n*2]=hints[i][n*2].replace(/Apps Menu/,'Top Sites')}}}},{key:'bumpKeypadHint',value:function bumpKeypadHint(){hintIndex++;if(hintIndex>=hints.length){hintIndex=-1;NextCaltrain.displayScreen('hero');return}else if(hintIndex===hints.length-1){NextCaltrain.populateSoftkeyMenu('','OK','')}document.getElementById('hint-above').innerHTML=hints[hintIndex][0];document.getElementById('hint-below').innerHTML=hints[hintIndex][2];if(Array.isArray(hints[hintIndex][1])){document.getElementById('mini-keypad').style['display']='flex';document.getElementById('hint-center').style['display']='none';for(var i=1;i<15;i++){var key=i<10?i:['l','r','c','o','h'][i-10];var cls=hints[hintIndex][1].indexOf(key)===-1?'default':'selected';document.getElementById(`k${key}`).className=cls}}else{document.getElementById('mini-keypad').style['display']='none';document.getElementById('hint-center').style['display']='block';document.getElementById('hint-center').innerHTML=hints[hintIndex][1]}}},{key:'moveMenuSelection',value:function moveMenuSelection(){var menuOptions=document.getElementById('menu-list').getElementsByTagName('li');if(menuIndex>=menuOptions.length){menuIndex=0}else if(menuIndex<0){menuIndex=menuOptions.length-1}for(var i=0;i<menuOptions.length;i++){menuOptions[i].className=menuIndex===i?'selected':''}}},{key:'setTheTime',value:function setTheTime(){var ourTime=new GoodTimes;var partTime=ourTime.partTime();schedule=new CaltrainSchedule(ourTime);document.getElementById('time').innerHTML=partTime[0];document.getElementById('ampm').innerHTML=partTime[1].toUpperCase();setTimeout(function(){NextCaltrain.setTheTime()},(60-ourTime.seconds)*1000);NextCaltrain.loadSchedule()}},{key:'setCountdown',value:function setCountdown(minutes){var downTime=new GoodTimes;var blurb=downTime.countdown(minutes);document.getElementById('blurb-grid').innerHTML=blurb;document.getElementById('blurb-hero').innerHTML=blurb;if(blurb!==''){var refresh=blurb.endsWith('sec')?1000:(60-downTime.seconds)*1000;countdown=setTimeout(function(){NextCaltrain.setCountdown(minutes)},refresh)}}},{key:'populateStops',value:function populateStops(labels){document.getElementById('origin-grid').innerHTML=labels[0];document.getElementById('destin-grid').innerHTML=labels[1];document.getElementById('origin-hero').innerHTML=labels[0];document.getElementById('destin-hero').innerHTML=labels[1]}},{key:'populateBlurb',value:function populateBlurb(message,textClass){document.getElementById('blurb-grid').innerHTML=message;document.getElementById('blurb-grid').className=textClass;document.getElementById('blurb-hero').innerHTML=message.replace(' Schedule','');document.getElementById('blurb-hero').className=textClass}},{key:'populateSoftkeyMenu',value:function populateSoftkeyMenu(left,center,right){document.getElementById('softkey-left').innerHTML=left;document.getElementById('softkey-center').innerHTML=center;document.getElementById('softkey-right').innerHTML=right}},{key:'loadTrip',value:function loadTrip(train){goodTime=new GoodTimes;var trip=new CaltrainTrip(train,schedule.label());var lines=[];for(var i=0;i<trip.times.length;i++){var stop=trip.times[i];var spacer=i===0?'':'|';var fullTime=GoodTimes.fullTime(stop[1]);var filler=fullTime.length>6?'':'0';var style=goodTime.inThePast(stop[1])?'message-departed':'message-arriving';var target=prefs.origin===stop[0]||prefs.destin===stop[0]?'target':'';lines.push(`<div class="station-stop">
          <div class="station-time"><br/><span
               class="hour-filler">${filler}</span>${fullTime}</div>
          <div class="station-spacer ${style}">${spacer}<br/><span
               class="station-dot ${target}">&#9679;</span></div>
          <div class="station-name"><br/>${stop[0]}</div></div>`)}listing.innerHTML=lines.join('\n');document.getElementById('trip-filler').innerHTML=trip.label();document.title=trip.label()}},{key:'loadSchedule',value:function loadSchedule(){goodTime=new GoodTimes;clearTimeout(countdown);NextCaltrain.populateStops(prefs.tripLabels());var routes=service.routes(prefs.origin,prefs.destin,schedule.label());var minutes=0;if(offset===null){minutes=goodTime.minutes;offset=CaltrainService.nextIndex(routes,minutes)}else if(offset>routes.length-1){offset=0}else if(offset<0){offset=routes.length-1}for(var i=0;i<6;i++){var tripCardElement=document.getElementById(`trip${i}`);var n=offset+i>routes.length-1?offset+i-routes.length:offset+i;var route=routes[n];if(i>routes.length-1){if(i===0){trainId=null;NextCaltrain.populateBlurb('NO TRAINS','message-departed blink');document.getElementById('circle').className='selection-departed';document.getElementById('trip0').className='selection-none';document.getElementById('trip').innerHTML='<span class="time-hero">&nbsp;</span>';document.getElementById('trip-type').innerHTML='&nbsp;';document.getElementById('title').innerHTML='Next Caltrain';document.title='Next Caltrain'}tripCardElement.innerHTML='<div class="train-time">&nbsp;</div>';continue}minutes=route[1];var originTime=GoodTimes.partTime(minutes);var destinTime=GoodTimes.partTime(route[2]);var card=`<div class="train-number">#${route[0]}</div>
          <div class="train-time">${originTime[0]}<span class="meridiem">${originTime[1]}</span></div>
          <div class="train-time">${destinTime[0]}<span class="meridiem">${destinTime[1]}</span></div>`;tripCardElement.innerHTML=card;if(i===0){var tripTime=`<span class="train-hero">#${route[0]}</span>
            <span class="time-hero">${originTime[0]}</span>
            <span class="meridiem-hero">${originTime[1]}</span>`;document.getElementById('trip').innerHTML=tripTime;trainId=route[0];var message=void 0,textClass=void 0,tripClass=void 0,wrapClass=void 0;if(schedule.swapped()){message=schedule.label()+' Schedule';textClass='message-departed';tripClass=goodTime.inThePast(minutes)?'message-departed':'';wrapClass='selection-departed'}else if(goodTime.inThePast(minutes)){message=schedule.label()+' Schedule';textClass='message-departed';tripClass='message-departed';wrapClass='selection-departed'}else if(goodTime.departing(minutes)){message='DEPARTING';textClass='message-departing blink';wrapClass='selection-departing'}else{message=goodTime.countdown(minutes);textClass='message-arriving';wrapClass='selection-arriving';if(minutes>0){NextCaltrain.setCountdown(minutes)}}document.getElementById('circle').className=wrapClass;document.getElementById('trip').className=tripClass;document.getElementById('trip-type').innerHTML=CaltrainTrip.type(trainId);if(trainId&&NextCaltrain.currentScreen()==='grid'){document.getElementById('title').innerHTML=`${CaltrainTrip.type(trainId)} Service`;document.title=`${CaltrainTrip.type(trainId)} Service`}tripCardElement.className=['trip-card','selection',tripClass,wrapClass].join(' ');NextCaltrain.populateBlurb(message,textClass)}else{if(goodTime.inThePast(minutes)){tripCardElement.className='trip-card message-departed'}else{tripCardElement.className='trip-card'}}}}},{key:'currentScreen',value:function currentScreen(){for(var i=0;i<screens.length;i++){if(document.getElementById(`${screens[i]}-screen`).style['display']==='flex')return screens[i]}return screens[0]}},{key:'displayScreen',value:function displayScreen(target){for(var i=0;i<screens.length;i++){var display=target===screens[i]?'flex':'none';document.getElementById(`${screens[i]}-screen`).style['display']=display}if(!kaiWeb){if(target==='hero'){NextCaltrain.populateSoftkeyMenu('','SELECT','Options')}else if(target==='grid'){NextCaltrain.populateSoftkeyMenu('','SELECT','Options')}else if(target==='trip'){NextCaltrain.populateSoftkeyMenu('','BACK','Options')}else if(target==='menu'){NextCaltrain.populateSoftkeyMenu('','SELECT','')}else if(target==='prefs'){NextCaltrain.populateSoftkeyMenu('Cancel','','OK')}else if(target==='about'){NextCaltrain.populateSoftkeyMenu('','OK','')}else if(target==='commands'){NextCaltrain.populateSoftkeyMenu('','NEXT','')}}document.getElementById('title').innerHTML='Next Caltrain';document.title=target in titles?titles[target]:'Next Caltrain';if(target==='grid'||target==='hero'){NextCaltrain.loadSchedule()}}},{key:'attachListeners',value:function attachListeners(){document.addEventListener('DOMContentLoaded',function(){if(app&&navigator.userAgent.toLowerCase().indexOf('kaios/2')>-1){getKaiAd({publisher:'8400043d-1768-4179-8a02-6bc7f7e62a25',app:'NextCaltrain',slot:'mainAdUnit',test:0,onerror:function onerror(err){return console.error('Custom catch:',err)},onready:function onready(ad){ad.call('display')}})}});document.addEventListener('touchstart',function(e){var code=null;if(e.target.id==='softkey-center'){code=OK}else if(e.target.id==='softkey-left'){code='sl'}else if(e.target.id==='softkey-right'){code='sr'}else if(e.target.getAttribute('value')==='about'){code='about'}else if(e.target.getAttribute('value')==='commands'){code='commands'}else if(e.target.getAttribute('value')==='prefs'){code='prefs'}else{return}NextCaltrain.press(code)});document.addEventListener('mousemove',function(e){if(!kaiWeb)return;skip=skip?false:true;if(kaiWeb&&splash&&e.clientX>=239){splash=false;NextCaltrain.displayScreen('hero')}else if(kaiWeb&&!splash&&e.clientX<239){splash=true;NextCaltrain.displayScreen('splash')}else if(e.mozMovementY>0){NextCaltrain.press(DOWN);if(skip){NextCaltrain.press(DOWN);skip=false}}else if(e.mozMovementY<0){NextCaltrain.press(UP);if(skip){NextCaltrain.press(UP);skip=false}}else if(e.mozMovementX===0&&!skip){if(e.clientY===0){NextCaltrain.press(UP)}else if(e.clientY>=vh-1){NextCaltrain.press(DOWN)}}});document.addEventListener('click',function(){if(kaiWeb){NextCaltrain.press(OK)}});document.addEventListener('keydown',function(e){var code=e.keyCode?e.keyCode:e.which;if(code===HANGUP){code=BACK;if(NextCaltrain.currentScreen()!=='hero'){e.preventDefault();e.stopPropagation()}else{return}}else if(e.key==='Call'||code===220){code='call'}else if(e.key==='SoftLeft'||e.key==='['){code='sl';e.preventDefault();e.stopPropagation()}else if(e.key==='SoftRight'||e.key===']'){code='sr';if(NextCaltrain.currentScreen()!=='menu'){e.preventDefault();e.stopPropagation()}}else if(e.key==='1'||e.key==='3'){e.preventDefault();e.stopPropagation()}else if(e.key==='2'){e.preventDefault();e.stopPropagation()}else if(code===OK){e.preventDefault();e.stopPropagation()}NextCaltrain.press(code)})}},{key:'press',value:function press(code){if(splash)return;if(code===ESC){NextCaltrain.displayScreen('hero')}else if(code==='prefs'){var confirmation=['Save',prefs.flipped?prefs.destin:prefs.origin,'as morning and',prefs.flipped?prefs.origin:prefs.destin,'as evening default stations?'].join(' ');document.getElementById('confirmation').innerHTML=confirmation;NextCaltrain.displayScreen('prefs')}else if(code==='about'){NextCaltrain.displayScreen('about')}else if(code==='commands'){NextCaltrain.bumpKeypadHint();NextCaltrain.displayScreen('commands')}else if(NextCaltrain.currentScreen()==='about'){if(code===OK||code===BACK){NextCaltrain.displayScreen('hero')}}else if(NextCaltrain.currentScreen()==='commands'){if(code===OK){NextCaltrain.bumpKeypadHint()}else if(code===BACK){hintIndex=-1;NextCaltrain.displayScreen('hero')}}else if(NextCaltrain.currentScreen()==='prefs'){if(kaiWeb&&code===OK||!kaiWeb&&code==='sr'){prefs.saveStops();NextCaltrain.displayScreen('hero')}else if(kaiWeb&&code===BACK||!kaiWeb&&(code==='sl'||code===SPLAT)){NextCaltrain.displayScreen('hero')}}else if(NextCaltrain.currentScreen()==='menu'){if(code===OK){var menuOptions=document.getElementById('menu-list').getElementsByTagName('li');var action=menuOptions[menuIndex].getAttribute('value');menuIndex=0;NextCaltrain.press(action)}else if(code===UP){menuIndex--}else if(code===DOWN){menuIndex++}else if(code===BACK){menuIndex=0;NextCaltrain.displayScreen('hero')}NextCaltrain.moveMenuSelection()}else if(code==='sr'){menuIndex=0;NextCaltrain.displayScreen('menu')}else if(NextCaltrain.currentScreen()==='trip'){if(code===OK||code===BACK){NextCaltrain.displayScreen('grid')}else if(code===UP){if(listing.scrollTop>0)listing.scrollTo(0,listing.scrollTop-72)}else if(code===DOWN){if(listing.scrollTop<listing.scrollHeight-228)listing.scrollTo(0,listing.scrollTop+72)}}else if(code===OK&&NextCaltrain.currentScreen()==='grid'&&trainId!==null){NextCaltrain.displayScreen('trip');NextCaltrain.loadTrip(trainId)}else{if(code===BACK){NextCaltrain.displayScreen('hero')}else if(code===OK){NextCaltrain.displayScreen('grid')}else if(code===UP){offset--}else if(code===DOWN){offset++}else if(code===49||code===55){offset=null;prefs.bumpStations(true,false)}else if(code===51||code===57){offset=null;prefs.bumpStations(true,true)}else if(code===52){offset=null;prefs.bumpStations(false,false)}else if(code===54){offset=null;prefs.bumpStations(false,true)}else if(code==='call'){offset=null;prefs.flipStations()}else if(code==='sl'){schedule.next();offset=null}else{return}NextCaltrain.loadSchedule()}}}]);return NextCaltrain}();
